---
title: 博客搭建流程
date: 2019-01-13 03:26:41
tags: hexo
category: 工具
---

# 关于搭建的流程

1. 创建仓库，http://CrazyMilk.github.io；
2. 创建两个分支：master 与 hexo；
3. 设置hexo为默认分支（因为我们只需要手动管理这个分支上的Hexo网站文件；
4. 使用git clone git@github.com:CrazyMilk/CrazyMilk.github.io.git拷贝仓库；
5. 在本地http://CrazyMilk.github.io文件夹下通过 Git bash依次执行npm install hexo、hexo init、npm install 和 npm install hexo-deployer-git（此时当前分支应显示为hexo）;
6. 修改 ==_config.yml==中的deploy参数，分支应为master；
7. 依次执行 ==git add .、git commit -m "..."、git push origin hexo==提交网站相关的文件；
8. 执行hexo g -d生成网站并部署到GitHub上。这样一来，在GitHub上http://CrazyMilk.github.io 仓库就有两个分支，一个hexo分支用来存放网站的原始文件，一个master分支用来存放生成的静态网页。完美( •̀ ω •́ )y！

# 关于日常的改动流程

在本地对博客进行修改（添加新博文、修改样式等等）后，通过下面的流程进行管理。

1. 依次执行git add .、git commit -m "..."、git push origin hexo指令将改动推送到GitHub（此时当前分支应为hexo）
2. 然后才执行hexo g -d发布网站到master分支上。

# 其它电脑操作流程

1. 使用git clone git@github.com:CrazyMilk/CrazyMilk.github.io.git拷贝仓库（默认分支为hexo);
2. 在本地新拷贝的http://CrazyMilk.github.io文件夹下通过Git bash依次执行下列指令：npm install hexo、npm install、npm install hexo-deployer-git（记得，不需要hexo init这条指令）。

# 常用配置操作

## 文章加密

打开next\layout\_partials\head\head.swig文件,插入以下代码:
如果没有head.swig custom-head.swig 也可以

``` javascript
<script>
    (function(){
        if('{{ page.password }}'){
            if (prompt('请输入文章密码') !== '{{ page.password }}'){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

```

新建文章 然后加入 password 具体操作如下:

```
title: 博客搭建流程
date: 2019-01-13 03:26:41
tags: hexo
category: 工具
password: 输入文章密码
```

## 将文章置顶

打开文件：node_modules/hexo-generator-index/lib/generator.js,将以下代码替换原来的;
```javascript
'use strict';
var pagination = require('hexo-pagination');
module.exports = function(locals){
  var config = this.config;
  var posts = locals.posts;
    posts.data = posts.data.sort(function(a, b) {
        if(a.top && b.top) { // 两篇文章top都有定义
            if(a.top == b.top) return b.date - a.date; // 若top值一样则按照文章日期降序排
            else return b.top - a.top; // 否则按照top值降序排
        }
        else if(a.top && !b.top) { // 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）
            return -1;
        }
        else if(!a.top && b.top) {
            return 1;
        }
        else return b.date - a.date; // 都没定义按照文章日期降序排
    });
  var paginationDir = config.pagination_dir || 'page';
  return pagination('', posts, {
    perPage: config.index_generator.per_page,
    layout: ['index', 'archive'],
    format: paginationDir + '/%d/',
    data: {
      __index: true
    }
  });
};

```
在文章中添加 top 值，数值越大文章越靠前，
```
title: 博客搭建流程
date: 2019-01-13 03:26:41
tags: hexo
category: 工具
password: 输入文章密码
top: 100
```
##  开启留言评论功能
[LeanCloud](https://leancloud.cn/)
在 next 主题中 _config.yml 找到 valine的配置并填写对应信息
[valine Api](https://valine.js.org/quickstart.html)
## 设置图像滚动效果

取消文子滚动:
```
/*
#wechat:hover p{
    animation: roll 0.1s infinite linear;
    -webkit-animation: roll 0.1s infinite linear;
    -moz-animation: roll 0.1s infinite linear;
}
#alipay:hover p{
    animation: roll 0.1s infinite linear;
    -webkit-animation: roll 0.1s infinite linear;
    -moz-animation: roll 0.1s infinite linear;
}
*/

```
## 在每篇文章末尾统一添加“本文结束”标记
1. 在\themes\next\layout\_macro下新建 passage-end-tag.swig 文件,并添加以下代码
``` javascript
<div>
    {% if not is_index %}
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-heart"></i>感谢阅读-------------</div>
    {% endif %}
</div>

```

2. 打开\themes\next\layout\_macro\post.swig文件，在post-body 之后， post-footer （post-footer之前有两个DIV）之前添加如下代码

```javascript
<div>
  {% if not is_index %}
    {% include 'passage-end-tag.swig' %}
  {% endif %}
</div>
```

3. 打开主题配置文件_config.yml在末尾添加以下字段：


```
# 文章末尾添加“本文结束”标记
passage_end_tag:
  enabled: true
```

**原文地址**

https://www.zhihu.com/question/21193762/answer/79109280
https://www.jianshu.com/p/52753aafd478